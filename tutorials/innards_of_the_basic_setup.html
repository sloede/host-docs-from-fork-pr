<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>19 Core aspects of the basic setup · Trixi.jl</title><meta name="title" content="19 Core aspects of the basic setup · Trixi.jl"/><meta property="og:title" content="19 Core aspects of the basic setup · Trixi.jl"/><meta property="twitter:title" content="19 Core aspects of the basic setup · Trixi.jl"/><meta name="description" content="Documentation for Trixi.jl."/><meta property="og:description" content="Documentation for Trixi.jl."/><meta property="twitter:description" content="Documentation for Trixi.jl."/><meta property="og:url" content="https://trixi-framework.github.io/Trixi.jl/stable/tutorials\\innards_of_the_basic_setup.html"/><meta property="twitter:url" content="https://trixi-framework.github.io/Trixi.jl/stable/tutorials\\innards_of_the_basic_setup.html"/><link rel="canonical" href="https://trixi-framework.github.io/Trixi.jl/stable/tutorials\\innards_of_the_basic_setup.html"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../index.html">Trixi.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Home</a></li><li><span class="tocitem">Getting started</span><ul><li><a class="tocitem" href="../overview.html">Overview</a></li><li><a class="tocitem" href="../visualization.html">Visualization</a></li><li><a class="tocitem" href="../restart.html">Restart simulation</a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="introduction.html">Introduction</a></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">1 First steps in Trixi.jl</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="getting_started.html">1.1 Getting started</a></li><li><a class="tocitem" href="create_first_setup.html">1.2 Create first setup</a></li><li><a class="tocitem" href="changing_trixi.html">1.3 Changing Trixi.jl itself</a></li></ul></li><li><a class="tocitem" href="scalar_linear_advection_1d.html">2 Introduction to DG methods</a></li><li><a class="tocitem" href="DGSEM_FluxDiff.html">3 DGSEM with flux differencing</a></li><li><a class="tocitem" href="shock_capturing.html">4 Shock capturing with flux differencing and stage limiter</a></li><li><a class="tocitem" href="non_periodic_boundaries.html">5 Non-periodic boundaries</a></li><li><a class="tocitem" href="DGMulti_1.html">6 DG schemes via <code>DGMulti</code> solver</a></li><li><a class="tocitem" href="DGMulti_2.html">7 Other SBP schemes (FD, CGSEM) via <code>DGMulti</code> solver</a></li><li><a class="tocitem" href="upwind_fdsbp.html">8 Upwind FD SBP schemes</a></li><li><a class="tocitem" href="adding_new_scalar_equations.html">9 Adding a new scalar conservation law</a></li><li><a class="tocitem" href="adding_nonconservative_equation.html">10 Adding a non-conservative equation</a></li><li><a class="tocitem" href="parabolic_terms.html">11 Parabolic terms</a></li><li><a class="tocitem" href="adding_new_parabolic_terms.html">12 Adding new parabolic terms</a></li><li><a class="tocitem" href="adaptive_mesh_refinement.html">13 Adaptive mesh refinement</a></li><li><a class="tocitem" href="structured_mesh_mapping.html">14 Structured mesh with curvilinear mapping</a></li><li><a class="tocitem" href="hohqmesh_tutorial.html">15 Unstructured meshes with HOHQMesh.jl</a></li><li><a class="tocitem" href="time_stepping.html">16 Explicit time stepping</a></li><li><a class="tocitem" href="differentiable_programming.html">17 Differentiable programming</a></li><li><a class="tocitem" href="custom_semidiscretization.html">18 Custom semidiscretizations</a></li><li class="is-active"><a class="tocitem" href="innards_of_the_basic_setup.html">19 Core aspects of the basic setup</a><ul class="internal"><li><a class="tocitem" href="#Basic-setup"><span>Basic setup</span></a></li><li><a class="tocitem" href="#Overview-of-the-[SemidiscretizationHyperbolic](@ref)-function"><span>Overview of the <code>SemidiscretizationHyperbolic</code> function</span></a></li><li><a class="tocitem" href="#Overview-of-the-[semidiscretize](@ref)-function"><span>Overview of the <code>semidiscretize</code> function</span></a></li><li><a class="tocitem" href="#Functions-solve-and-rhs!"><span>Functions <code>solve</code> and <code>rhs!</code></span></a></li><li><a class="tocitem" href="#Package-versions"><span>Package versions</span></a></li></ul></li></ul></li><li><span class="tocitem">Basic building blocks</span><ul><li><input class="collapse-toggle" id="menuitem-4-1" type="checkbox"/><label class="tocitem" for="menuitem-4-1"><span class="docs-label">Meshes</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../meshes/tree_mesh.html">Tree mesh</a></li><li><a class="tocitem" href="../meshes/structured_mesh.html">Structured mesh</a></li><li><a class="tocitem" href="../meshes/unstructured_quad_mesh.html">Unstructured mesh</a></li><li><a class="tocitem" href="../meshes/p4est_mesh.html">P4est-based mesh</a></li><li><a class="tocitem" href="../meshes/dgmulti_mesh.html">DGMulti mesh</a></li></ul></li><li><a class="tocitem" href="../time_integration.html">Time integration</a></li><li><a class="tocitem" href="../callbacks.html">Callbacks</a></li></ul></li><li><span class="tocitem">Advanced topics &amp; developers</span><ul><li><a class="tocitem" href="../conventions.html">Conventions</a></li><li><a class="tocitem" href="../development.html">Development</a></li><li><a class="tocitem" href="../github-git.html">GitHub &amp; Git</a></li><li><a class="tocitem" href="../styleguide.html">Style guide</a></li><li><a class="tocitem" href="../testing.html">Testing</a></li><li><a class="tocitem" href="../performance.html">Performance</a></li><li><a class="tocitem" href="../parallelization.html">Parallelization</a></li></ul></li><li><a class="tocitem" href="../troubleshooting.html">Troubleshooting and FAQ</a></li><li><span class="tocitem">Reference</span><ul><li><a class="tocitem" href="../reference-trixi.html">Trixi.jl</a></li><li><a class="tocitem" href="../reference-trixi2vtk.html">Trixi2Vtk.jl</a></li></ul></li><li><a class="tocitem" href="../authors.html">Authors</a></li><li><a class="tocitem" href="../contributing.html">Contributing</a></li><li><a class="tocitem" href="../code_of_conduct.html">Code of Conduct</a></li><li><a class="tocitem" href="../license.html">License</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href="innards_of_the_basic_setup.html">19 Core aspects of the basic setup</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="innards_of_the_basic_setup.html">19 Core aspects of the basic setup</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/ArseniyKholod/Trixi.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/ArseniyKholod/Trixi.jl/blob/main/docs/literate/src/files/innards_of_the_basic_setup.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="innards_of_the_basic_setup"><a class="docs-heading-anchor" href="#innards_of_the_basic_setup">19: Core aspects of the basic setup</a><a id="innards_of_the_basic_setup-1"></a><a class="docs-heading-anchor-permalink" href="#innards_of_the_basic_setup" title="Permalink"></a></h1><p><a href="https://mybinder.org/v2/gh/trixi-framework/Trixi.jl/tutorial_notebooks?filepath=tutorials/notebooks/innards_of_the_basic_setup.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/trixi-framework/Trixi.jl/blob/tutorial_notebooks/tutorials/notebooks/innards_of_the_basic_setup.ipynb"><img src="https://raw.githubusercontent.com/jupyter/design/master/logos/Badges/nbviewer_badge.svg" alt/></a> <a href="https://raw.githubusercontent.com/trixi-framework/Trixi.jl/tutorial_notebooks/tutorials/notebooks/innards_of_the_basic_setup.ipynb"><img src="https://camo.githubusercontent.com/aea75103f6d9f690a19cb0e17c06f984ab0f472d9e6fe4eadaa0cc438ba88ada/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f646f776e6c6f61642d6e6f7465626f6f6b2d627269676874677265656e" alt/></a></p><p>This tutorial aims to provide insights into the Trixi.jl framework, with a focus on commonly used complex functions. These functions may lack clarity in their names and brief documentation descriptions.</p><p>We will guide you through a simplified setup, emphasizing functionalities that may not be evident to an average user. This setup is based on stable parts of Trixi.jl that are unlikely to undergo significant changes in the near future. Nevertheless, it will clarify fundamental concepts that continue to be applied in more recent and flexible configurations.</p><h2 id="Basic-setup"><a class="docs-heading-anchor" href="#Basic-setup">Basic setup</a><a id="Basic-setup-1"></a><a class="docs-heading-anchor-permalink" href="#Basic-setup" title="Permalink"></a></h2><p>Import essential libraries and specify an equation.</p><pre><code class="language-julia hljs">using Trixi, OrdinaryDiffEq
equations=LinearScalarAdvectionEquation2D((-0.2,0.7))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">┌──────────────────────────────────────────────────────────────────────────────────────────────────┐
│ LinearScalarAdvectionEquation2D                                                                  │
│ ═══════════════════════════════                                                                  │
│ #variables: ………………………………………………… 1                                                                │
│ │ variable 1: …………………………………………… scalar                                                           │
└──────────────────────────────────────────────────────────────────────────────────────────────────┘</code></pre><p>Generate a geometrical instruction for spatial discretization using <a href="../reference-trixi.html#Trixi.TreeMesh"><code>TreeMesh</code></a> with pre-coarsened cell.</p><pre><code class="language-julia hljs">coordinates_min = (-2.0, -2.0)
coordinates_max = (2.0, 2.0)

coarsening_patches = ( # Coarsen cell in the lower-right quarter
  (type=&quot;box&quot;, coordinates_min=[0.0, -2.0], coordinates_max=[2.0, 0.0]),
)

 mesh = TreeMesh(coordinates_min, coordinates_max, initial_refinement_level=2,
                 n_cells_max=30_000,
                 coarsening_patches=coarsening_patches)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">┌──────────────────────────────────────────────────────────────────────────────────────────────────┐
│ TreeMesh{2, Trixi.SerialTree{2}}                                                                 │
│ ════════════════════════════════                                                                 │
│ center: …………………………………………………………… [0.0, 0.0]                                                       │
│ length: …………………………………………………………… 4.0                                                              │
│ periodicity: ……………………………………………… (true, true)                                                     │
│ current #cells: ……………………………………… 17                                                               │
│ #leaf-cells: ……………………………………………… 13                                                               │
│ maximum #cells: ……………………………………… 30000                                                            │
└──────────────────────────────────────────────────────────────────────────────────────────────────┘</code></pre><p>Created <code>TreeMesh</code> looks like:</p><p><img src="https://github.com/trixi-framework/Trixi.jl/assets/119304909/d5ef76ee-8246-4730-a692-b472c06063a3" alt="TreeMesh_example"/></p><p>Instantiate a <a href="../reference-trixi.html#Trixi.DGSEM"><code>DGSEM</code></a> solver with a user-specified polynomial degree. The solver&#39;s objective is to define the <code>polydeg + 1</code> Gauss-Lobatto nodes, and their associated weights within the reference interval [-1, 1]. These nodes will be subsequently used to approximate solutions on each leaf cell of the <code>TreeMesh</code>.</p><pre><code class="language-julia hljs">solver = DGSEM(polydeg=3)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">┌──────────────────────────────────────────────────────────────────────────────────────────────────┐
│ DG{Float64}                                                                                      │
│ ═══════════                                                                                      │
│ basis: ……………………………………………………………… LobattoLegendreBasis{Float64}(polydeg=3)                         │
│ mortar: …………………………………………………………… LobattoLegendreMortarL2{Float64}(polydeg=3)                      │
│ surface integral: ………………………………… SurfaceIntegralWeakForm                                          │
│ │ surface flux: ……………………………………… flux_central                                                     │
│ volume integral: …………………………………… VolumeIntegralWeakForm                                           │
└──────────────────────────────────────────────────────────────────────────────────────────────────┘</code></pre><p>Gauss-Lobatto nodes with <code>N=4</code>:</p><p><img src="https://github.com/trixi-framework/Trixi.jl/assets/119304909/401e5e85-026e-48b6-8a1f-dca0306f3bb0" alt="Gauss-Lobatto_nodes_example"/></p><h2 id="Overview-of-the-[SemidiscretizationHyperbolic](@ref)-function"><a class="docs-heading-anchor" href="#Overview-of-the-[SemidiscretizationHyperbolic](@ref)-function">Overview of the <a href="../reference-trixi.html#Trixi.SemidiscretizationHyperbolic"><code>SemidiscretizationHyperbolic</code></a> function</a><a id="Overview-of-the-[SemidiscretizationHyperbolic](@ref)-function-1"></a><a class="docs-heading-anchor-permalink" href="#Overview-of-the-[SemidiscretizationHyperbolic](@ref)-function" title="Permalink"></a></h2><p>At this stage, all the necessary components for configuring domain discretization are in place. The remaining task is to combine these components into a single structure that will be used throughout the entire solving process. This is where <a href="../reference-trixi.html#Trixi.SemidiscretizationHyperbolic"><code>SemidiscretizationHyperbolic</code></a> comes into play.</p><pre><code class="language-julia hljs">semi = SemidiscretizationHyperbolic(mesh, equations, initial_condition_convergence_test, solver)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">┌──────────────────────────────────────────────────────────────────────────────────────────────────┐
│ SemidiscretizationHyperbolic                                                                     │
│ ════════════════════════════                                                                     │
│ #spatial dimensions: ………………………… 2                                                                │
│ mesh: ………………………………………………………………… TreeMesh{2, Trixi.SerialTree{2}} with length 17                  │
│ equations: …………………………………………………… LinearScalarAdvectionEquation2D                                  │
│ initial condition: ……………………………… initial_condition_convergence_test                               │
│ boundary conditions: ………………………… Trixi.BoundaryConditionPeriodic                                  │
│ source terms: …………………………………………… nothing                                                          │
│ solver: …………………………………………………………… DG                                                               │
│ total #DOFs per field: …………………… 208                                                              │
└──────────────────────────────────────────────────────────────────────────────────────────────────┘</code></pre><p>The <code>SemidiscretizationHyperbolic</code> function calls numerous sub-functions to perform the necessary steps. A brief description of the key sub-functions is provided below.</p><ul><li><p><code>init_elements(leaf_cell_ids, mesh, equations, dg.basis, RealT, uEltype)</code></p><p>As was already mentioned, the fundamental elements for approximating a solution are the leaf cells. This implies that on each leaf cell, the solution is treated as a polynomial of the degree specified in the <code>DGSEM</code> solver and evaluated at the Gauss-Lobatto nodes, which were previously illustrated. To provide this, the <code>init_elements</code> function extracts these leaf cells from the <code>TreeMesh</code>, assigns them the label &quot;elements&quot;, records their coordinates, and maps the Gauss-Lobatto nodes from the 1D interval [-1, 1] onto each axis of every element.</p><p><img src="https://github.com/trixi-framework/Trixi.jl/assets/119304909/534131bd-e85b-43d5-860d-2db6e60ce921" alt="elements_example"/></p><p>The visualization of elements with nodes includes spaces between elements, which do not exist in  reality. This spacing is included only for illustrative purposes to underscore the separation of elements and the independent projection of nodes onto each element.</p></li><li><p><code>init_interfaces(leaf_cell_ids, mesh, elements)</code></p><p>At this point, the elements with nodes have been defined; however, they lack the necessary communication functionality. This is crucial because the solutions on the elements are not independent of each other. Furthermore, nodes on the boundary of adjacent elements share the same spatial location, requiring a method to combine their solutions.</p><p>As demonstrated earlier, the elements can have varying sizes. Let us initially consider neighbors with equal size. For these elements, the <code>init_interfaces</code> function generates interfaces that store information about adjacent elements, their relative positions, and allocate containers for sharing solutions between neighbors during the solving process.</p><p>In our visualization, these interfaces would conceptually resemble tubes connecting the corresponding elements.</p><p><img src="https://github.com/trixi-framework/Trixi.jl/assets/119304909/bc3b6b02-afbc-4371-aaf7-c7bdc5a6c540" alt="interfaces_example"/></p></li><li><p><code>init_mortars(leaf_cell_ids, mesh, elements, dg.mortar)</code></p><p>Returning to the consideration of different sizes among adjacent elements, within the <code>TreeMesh</code>, adjacent leaf cells can vary in size by a maximum factor of two. This implies that a coarsened element on each side, excluding the domain boundaries, has one neighbor of equal size with a connection through an interface, or two neighbors with sizes two times smaller, requiring a connection through so called &quot;mortars&quot;.</p><p>Mortars store information about the connected elements, their relative positions, and allocate containers for sharing solutions between these elements along their boundaries.</p><p>In our visualization, mortars are represented as branched tubes.</p><p><img src="https://github.com/trixi-framework/Trixi.jl/assets/119304909/43a95a60-3a31-4b1f-8724-14049e7a0481" alt="mortars_example"/></p></li><li><p><code>init_boundaries(leaf_cell_ids, mesh, elements)</code></p><p>In order to apply boundary conditions, it is necessary to identify the locations of the boundaries. Therefore, we initialize a &quot;boundaries&quot; object, which records the elements that contain boundaries, specifies which side of an element is a boundary, stores the coordinates of boundary nodes, and allocates containers for managing solutions at these boundaries.</p><p>In our visualization, boundaries and their corresponding nodes are highlighted with green, semi-transparent lines.</p><p><img src="https://github.com/trixi-framework/Trixi.jl/assets/119304909/21996b20-4a22-4dfb-b16a-e2c22c2f29fe" alt="boundaries_example"/></p></li></ul><p>All the structures mentioned earlier are packed as a cache of type <code>Tuple</code>. Subsequently, an object of type <code>SemidiscretizationHyperbolic</code> is initialized using this cache, initial and boundary conditions, equations, mesh and solver.</p><p>In conclusion, <code>Semidiscretization</code>&#39;s primary function is to collect equations, the geometric representation of the domain, and approximation instructions, creating specialized structures to interconnect these components in a manner that enables their utilization for the numerical solution of partial differential equations (PDEs).</p><p>As evident from the earlier description of <code>SemidiscretizationHyperbolic</code>, it comprises numerous functions called recursively. Without delving into details, the structure of the primary calls can be illustrated as follows:</p><p><img src="https://github.com/trixi-framework/Trixi.jl/assets/119304909/2cdfe3d1-f88a-4028-b83c-908d34d400cd" alt="SemidiscretizationHyperbolic_structure"/></p><h2 id="Overview-of-the-[semidiscretize](@ref)-function"><a class="docs-heading-anchor" href="#Overview-of-the-[semidiscretize](@ref)-function">Overview of the <a href="../reference-trixi.html#SummationByPartsOperators.semidiscretize-Tuple{SemidiscretizationHyperbolicParabolic, Any}"><code>semidiscretize</code></a> function</a><a id="Overview-of-the-[semidiscretize](@ref)-function-1"></a><a class="docs-heading-anchor-permalink" href="#Overview-of-the-[semidiscretize](@ref)-function" title="Permalink"></a></h2><p>At this stage, we have defined the equations and configured the domain&#39;s discretization. The final step before solving is to select a suitable time span and apply the corresponding initial conditions, which are already stored in the initialized <code>SemidiscretizationHyperbolic</code> object.</p><p>The purpose of the <a href="../reference-trixi.html#SummationByPartsOperators.semidiscretize-Tuple{SemidiscretizationHyperbolicParabolic, Any}"><code>semidiscretize</code></a> function is to wrap the semi-discretization as an <code>ODEProblem</code> within the specified time interval, while also applying the initial conditions at the left boundary of this interval. This <code>ODEProblem</code> can be subsequently passed to the <code>solve</code> function from the OrdinaryDiffEq.jl package.</p><pre><code class="language-julia hljs">ode = semidiscretize(semi, (0.0, 1.0));</code></pre><p>The <code>semidiscretize</code> function involves a deep tree of recursive calls, with the primary ones explained below.</p><ul><li><p><code>allocate_coefficients(mesh, equations, solver, cache)</code></p><p>To apply initial conditions, a container needs to be generated to store the initial values of the target variables for each node within each element. The <code>allocate_coefficients</code> function initializes <code>u_ode</code> as a 1D zero-vector with a length that depends on the number of variables, elements, nodes, and dimensions. The use of a 1D vector format is consistent with the requirements of the ODE-solvers from OrdinaryDiffEq.jl. Therefore, Trixi.jl follows this format to be able to utilize the functionalities of OrdinaryDiffEq.jl.</p></li><li><p><code>wrap_array(u_ode, semi)</code></p><p>As previously noted, <code>u_ode</code> is constructed as a 1D vector to ensure compatibility with OrdinaryDiffEq.jl. However, for internal use within Trixi.jl, identification which part of the vector relates to specific variables, elements and nodes can be challenging.</p><p>This is why the <code>u_ode</code> vector is wrapped by the <code>wrap_array</code> function to create a multidimensional array <code>u</code>, with each dimension representing variables, nodes and elements. Consequently, navigation within this multidimensional array becomes noticeably easier.</p><p>&quot;Wrapping&quot; in this context involves the creation of a reference to the same storage location but with an alternative structural representation. This approach enables the use of both instances <code>u</code> and <code>u_ode</code> as needed, so that changes are simultaneously reflected in both. This is possible because, from a storage perspective, they share the same stored data, while access to this data is provided in different ways.</p></li><li><p><code>compute_coefficients!(u, initial_conditions, t, mesh::DG, equations, solver, cache)</code></p><p>Now the variable <code>u</code>, intended to store solutions, has been allocated and wrapped, it is time to apply the initial conditions. The <code>compute_coefficients!</code> function calculates the initial conditions for each variable at every node within each element and properly stores them in the <code>u</code> array.</p></li></ul><p>At this stage, the <code>semidiscretize</code> function has all the necessary components to initialize and return an <code>ODEProblem</code> object, which will be used by the <code>solve</code> function to compute the solution.</p><p>In summary, the internal workings of <code>semidiscretize</code> with brief descriptions can be presented as follows.</p><p><img src="https://github.com/trixi-framework/Trixi.jl/assets/119304909/491eddc4-aadb-4e29-8c76-a7c821d0674e" alt="semidiscretize_structure"/></p><h2 id="Functions-solve-and-rhs!"><a class="docs-heading-anchor" href="#Functions-solve-and-rhs!">Functions <code>solve</code> and <code>rhs!</code></a><a id="Functions-solve-and-rhs!-1"></a><a class="docs-heading-anchor-permalink" href="#Functions-solve-and-rhs!" title="Permalink"></a></h2><p>Once the <code>ODEProblem</code> object is initialized, the <code>solve</code> function and one of the ODE-solvers from the OrdinaryDiffEq.jl package can be utilized to compute an approximated solution using the instructions contained in the <code>ODEProblem</code> object.</p><pre><code class="language-julia hljs">sol = solve(ode, CarpenterKennedy2N54(williamson_condition=false), dt=0.01, save_everystep=false);</code></pre><p>Since the <code>solve</code> function and the ODE-solver are defined in another package without knowledge of how to handle discretizations performed in Trixi.jl, it is necessary to define the right-hand-side function, <code>rhs!</code>, within Trixi.jl.</p><p>Trixi.jl includes a set of <code>rhs!</code> functions designed to compute <code>du</code> according to the structure of the setup. These <code>rhs!</code> functions calculate interface, mortars, and boundary fluxes, in addition to surface and volume integrals, in order to construct the <code>du</code> vector. This <code>du</code> vector is then used by the time integration method to derive solutions in the subsequent time step. The <code>rhs!</code> function is called by time integration methods in each iteration of the solve-loop within OrdinaryDiffEq.jl, with arguments <code>du</code>, <code>u</code>, <code>Semidiscretization</code>, and the time step.</p><p>The problem is that <code>rhs!</code> functions within Trixi.jl are specialized for specific solver and mesh types. However, the types of arguments passed to <code>rhs!</code> by time integration methods do not explicitly provide this information. Consequently, Trixi.jl uses a two-levels approach for <code>rhs!</code> functions. The first level is limited to a single function for each <code>semidiscretization</code> type, and its role is to redirect data to the target <code>rhs!</code>. It performs this by extracting the necessary data from the integrator and passing them, along with the originally received arguments, to the specialized for solver and mesh types <code>rhs!</code> function, which is responsible for calculating <code>du</code>.</p><p>Path from the <code>solve</code> function call to the appropriate <code>rhs!</code> function call:</p><p><img src="https://github.com/trixi-framework/Trixi.jl/assets/119304909/dbea9a0e-25a4-4afa-855e-01f1ad619982" alt="rhs_structure"/></p><p>Computed solution:</p><pre><code class="language-julia hljs">using Plots
plot(sol)
pd = PlotData2D(sol)
plot!(getmesh(pd))</code></pre><img src="innards_of_the_basic_setup-2fff32f0.svg" alt="Example block output"/><h2 id="Package-versions"><a class="docs-heading-anchor" href="#Package-versions">Package versions</a><a id="Package-versions-1"></a><a class="docs-heading-anchor-permalink" href="#Package-versions" title="Permalink"></a></h2><p>These results were obtained using the following versions.</p><pre><code class="language-julia hljs">using InteractiveUtils
versioninfo()

using Pkg
Pkg.status([&quot;Trixi&quot;, &quot;OrdinaryDiffEq&quot;, &quot;Plots&quot;, &quot;ForwardDiff&quot;],
           mode=PKGMODE_MANIFEST)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Julia Version 1.9.3
Commit bed2cd540a (2023-08-24 14:43 UTC)
Build Info:
  Official https://julialang.org/ release
Platform Info:
  OS: Windows (x86_64-w64-mingw32)
  CPU: 6 × AMD Ryzen 5 4500U with Radeon Graphics
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-14.0.6 (ORCJIT, znver2)
  Threads: 1 on 6 virtual cores
<span class="sgr32"><span class="sgr1">Status</span></span> `D:\work\Trixi.jl.my\docs\Manifest.toml`
  <span class="sgr90">[f6369f11] </span>ForwardDiff v0.10.36
  <span class="sgr90">[1dea7af3] </span>OrdinaryDiffEq v6.56.0
  <span class="sgr90">[91a5bcdd] </span>Plots v1.39.0
  <span class="sgr90">[a7f1ee26] </span>Trixi v0.5.48-pre `D:\work\Trixi.jl.my`</code></pre><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="custom_semidiscretization.html">« 18 Custom semidiscretizations</a><a class="docs-footer-nextpage" href="../meshes/tree_mesh.html">Tree mesh »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.0.1 on <span class="colophon-date" title="Thursday 2 November 2023 10:36">Thursday 2 November 2023</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
